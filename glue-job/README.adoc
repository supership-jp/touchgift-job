= Glue-Job
:TOC:

== CI/CD, 動作確認

**階層**

[source,text]
----
baroque
└── staging(環境) ex)staging, production
    └── beta(workspace) ex) beta, e ②
        └── evserver アプリケーション
            └── job.py ①の部分
----

1. **コードのバージョン管理**

- GitリポジトリにGlueジョブのスクリプト（例: `job.py`）を追加。①の部分

2. **CI/CDツールの設定**
- beta, featureのprefixがつくブランチにpushすればs3にdeployされる
- GitHubActionsを使用 *codebuildはまだ実装していないので一旦githubactionsのみで簡潔させる
- CI/CDパイプラインにおいて、以下のステージを設定:
- **コードの取得**: Gitからコードを取得。
- **S3へのデプロイ**: GlueジョブのスクリプトをS3にアップロード。②で設定しているworkspaceに配置される

3. **テストの実行**
- Glueジョブのテストをローカルで実行可能にするため、`aws-glue-libs`を使用したローカル環境を構築。
- テスト環境でのジョブ実行:
[source,bash]
----
aws-vault exec tpo-staging -- aws glue start-job-run --job-name <glue-job-name> --arguments '{"--mode":"test"}'
----